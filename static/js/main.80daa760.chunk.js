(this["webpackJsonpspotify-playlist-manager"]=this["webpackJsonpspotify-playlist-manager"]||[]).push([[0],{37:function(e,t,a){e.exports=a(68)},42:function(e,t,a){},66:function(e,t,a){},68:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(31),i=a.n(c),s=(a(42),a(15)),o=a(7),u=Object(n.createContext)({}),l={ACCESS_TOKEN:{key:"accessToken",type:"string"},ME:{key:"me",type:"object"}},d=function(e){var t=e.children,a=function(){return localStorage.clear()};return r.a.createElement(u.Provider,{value:{APP_STATE_VALUES:l,getPersistedState:function(e){try{if("object"===e.type){var t=localStorage.getItem(e.key);return t?JSON.parse(t):null}return localStorage.getItem(e.key)}catch(n){a()}},setPersistedState:function(e,t){"object"===e.type?localStorage.setItem(e.key,JSON.stringify(t)):localStorage.setItem(e.key,t)},clearPersistedState:a}},t)},p=a(8),f=a(35),m=a(11),b=["user-read-private","user-read-email","playlist-read-collaborative","playlist-modify-public","playlist-read-private","playlist-modify-private"],h=window.location.hash.substring(1).split("&").reduce((function(e,t){if(t){var a=t.split("=");e[a[0]]=decodeURIComponent(a[1])}return e}),{}),v=["37i9dQZF1E396S6lMfWgMr","37i9dQZF1E37668qIGJAPy","37i9dQZF1E38kE5eusdyAj","37i9dQZF1E39PcKoUK0RQ5","37i9dQZF1E38F06FDwNi27","37i9dQZF1E38FbWIM4PDxJ"],y=function(){var e=Object(n.useContext)(u),t=e.APP_STATE_VALUES.ACCESS_TOKEN,a=e.setPersistedState,c=Object(n.useState)(!1),i=Object(p.a)(c,2),s=i[0],l=i[1],d=Object(n.useState)(!1),v=Object(p.a)(d,2),y=v[0],g=v[1];return Object(n.useEffect)((function(){var e=h.access_token;e&&(a(t,e),g(!0))}),[a,t]),y?r.a.createElement(o.a,{to:"/home"}):r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},s?r.a.createElement(f.a,{animation:"border",role:"status"}):r.a.createElement("a",{className:"btn btn--loginApp-link",href:"".concat("https://accounts.spotify.com/authorize","?client_id=").concat("7719deb8aec14035bd2d6d603b240f78","&redirect_uri=").concat("https://matthewfbenjamin.github.io/react-spotify","&scope=").concat(b.join("%20"),"&response_type=token&show_dialog=true"),onClick:function(){return l(!0)}},r.a.createElement(m.a,{variant:"success"},"Login to Spotify"))))},g=a(1),k=a.n(g),x=a(6),E=a(10),j=a.n(E),O=function(e){var t=e.isLoading,a=e.onClick,n=e.loadingText,c=e.defaultText,i=e.error;return r.a.createElement("div",null,r.a.createElement(m.a,{variant:"success",onClick:t?null:a,disabled:t},t?n:c),i&&r.a.createElement("div",{style:{marginTop:8,color:"red"}},i.message||i))},S=a(12),w=function(){var e=Object(x.a)(k.a.mark((function e(t,a,n,r){var c,i,s,o,u,l,d,p;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c=j.a.create({baseURL:"https://api.spotify.com/v1",headers:{Authorization:"Bearer ".concat(t)}}),i=function(){var e=Object(x.a)(k.a.mark((function e(t,a){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.post("/playlists/".concat(t,"/tracks"),{uris:a});case 2:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),s=function(){var e=Object(x.a)(k.a.mark((function e(t,a){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,c.put("/playlists/".concat(t,"/tracks"),{uris:a});case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),a(Object(S.a)({},n,{isLoading:!0,error:null})),e.next=7,c.get("/playlists/".concat("37i9dQZF1EfMJO4KCTeoFL"));case 7:if(!((o=e.sent).data&&o.data.tracks&&o.data.tracks.items&&o.data.tracks.items.length>0&&r)){e.next=26;break}return e.next=11,c.get("/me/playlists");case 11:if(e.sent.data.items.forEach((function(e){"Daily Drive (No Podcasts)"===e.name&&(u=e.id)})),l=o.data.tracks.items.reduce((function(e,t,a){return a>0&&"track"===t.track.type&&"Spotify"!==t.track.artists[0].name&&e.push(t.track.uri),e}),[]),!u){e.next=19;break}return e.next=17,s(u,l);case 17:e.next=25;break;case 19:return e.next=21,c.post("/users/".concat(r.id,"/playlists"),{name:"Daily Drive (No Podcasts)",public:!1,collaborative:!1});case 21:return d=e.sent,p=d.data,e.next=25,i(p.id,l);case 25:a(Object(S.a)({},n,{isLoading:!1}));case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(0),a({isLoading:!1,didLoad:!0,error:e.t0});case 31:case"end":return e.stop()}}),e,null,[[0,28]])})));return function(t,a,n,r){return e.apply(this,arguments)}}(),L=a(36),P=function(){var e=Object(x.a)(k.a.mark((function e(t,a,n,r){var c,i,s,o,u,l,d,p,f,m,b,h,y;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,c=j.a.create({baseURL:"https://api.spotify.com/v1",headers:{Authorization:"Bearer ".concat(t)}}),i=function(){var e=Object(x.a)(k.a.mark((function e(t,a){var n,r=arguments;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>2&&void 0!==r[2]?r[2]:0,e.next=3,c.post("/playlists/".concat(t,"/tracks"),{uris:a,position:n});case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),s=function(){var e=Object(x.a)(k.a.mark((function e(t,a){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.put("/playlists/".concat(t,"/tracks"),{uris:a});case 2:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),o=function(e,t){return new Promise((function(a){e.forEach((function(e){return t.push(e.track.uri)})),a()}))},u=function(e,t,a){return new Promise((function(n){n(e.slice(t,a))}))},l=function(e,t){return new Promise(function(){var a=Object(x.a)(k.a.mark((function a(n,o){var l,p,f,m,b,h;return k.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return p=(l=0===e)?0:100*e,a.next=4,u(d,p,p+100);case 4:if(f=a.sent,m=t,0!==e||t){a.next=16;break}return a.next=9,c.post("/users/".concat(r.id,"/playlists"),{name:"Daily Mixes (Combined)",public:!1,collaborative:!1});case 9:return b=a.sent,h=b.data,m=h.id,a.next=14,i(h.id,f);case 14:a.next=23;break;case 16:if(!l){a.next=21;break}return a.next=19,s(t,f);case 19:a.next=23;break;case 21:return a.next=23,i(t,f,100*e);case 23:n(m);case 24:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}())},a(Object(S.a)({},n,{isLoading:!0,error:null})),d=[],p=Object(L.a)(v),e.prev=10,p.s();case 12:if((f=p.n()).done){e.next=22;break}return m=f.value,e.next=16,c.get("/playlists/".concat(m));case 16:if(!((b=e.sent).data&&b.data.tracks&&b.data.tracks.items&&b.data.tracks.items.length>0&&r)){e.next=20;break}return e.next=20,o(b.data.tracks.items,d);case 20:e.next=12;break;case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(10),p.e(e.t0);case 27:return e.prev=27,p.f(),e.finish(27);case 30:return e.next=32,c.get("/me/playlists");case 32:e.sent.data.items.forEach((function(e){"Daily Mixes (Combined)"===e.name&&(h=e.id)})),y=0;case 35:if(!(y<Math.ceil(d.length/100))){e.next=42;break}return e.next=38,l(y,h);case 38:h=e.sent;case 39:y++,e.next=35;break;case 42:a(Object(S.a)({},n,{isLoading:!1})),e.next=48;break;case 45:e.prev=45,e.t1=e.catch(0),"Request failed with status code 401"===e.t1&&a({isLoading:!1,didLoad:!0,error:e.t1});case 48:case"end":return e.stop()}}),e,null,[[0,45],[10,24,27,30]])})));return function(t,a,n,r){return e.apply(this,arguments)}}(),C=function(){var e=Object(n.useContext)(u),t=e.APP_STATE_VALUES,a=t.ACCESS_TOKEN,c=t.ME,i=e.getPersistedState,s=e.setPersistedState,l=e.clearPersistedState,d=Object(n.useState)(!1),f=Object(p.a)(d,2),b=f[0],h=f[1],v=Object(n.useState)({isLoading:!1,didLoad:!1,error:null}),y=Object(p.a)(v,2),g=y[0],E=y[1],S=Object(n.useState)({isLoading:!1,didLoad:!1,error:null}),L=Object(p.a)(S,2),C=L[0],A=L[1],T=Object(n.useState)(null),_=Object(p.a)(T,2),D=_[0],F=_[1],M=i(a);return Object(n.useEffect)((function(){var e=function(){var e=Object(x.a)(k.a.mark((function e(){var t,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.a.get("https://api.spotify.com/v1/me",{headers:{Authorization:"Bearer ".concat(M)}});case 3:t=e.sent,a=t.data,s(c,a),F(a),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),h(!0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),t=i(c);t?F(t):e()}),[c,M,i,s]),!M||b?r.a.createElement(o.a,{to:"/login"}):r.a.createElement("div",{style:{padding:"30px",minHeight:"100vh",display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"center"}},D&&r.a.createElement(r.a.Fragment,null,r.a.createElement(O,{isLoading:g.isLoading,onClick:function(){return w(M,E,g,D)},loadingText:"Removing...",defaultText:"Remove Podcasts from Daily Drive",error:g.error}),r.a.createElement(O,{isLoading:C.isLoading,onClick:function(){return P(M,A,C,D)},loadingText:"Combining...",defaultText:"Combine all Daily Mixes",error:C.error})),r.a.createElement("div",null,r.a.createElement(m.a,{variant:"danger",onClick:function(){l(),h(!0)}},"Logout")))},A=(a(66),function(){return r.a.createElement(d,null,r.a.createElement(s.a,null,r.a.createElement(o.d,null,r.a.createElement(o.b,{path:"/login"},r.a.createElement(y,null)),r.a.createElement(o.b,{path:"/home"},r.a.createElement(C,null)),r.a.createElement(o.b,{path:"/"},r.a.createElement(o.a,{to:"/login"})))))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(67);i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(A,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[37,1,2]]]);
//# sourceMappingURL=main.80daa760.chunk.js.map